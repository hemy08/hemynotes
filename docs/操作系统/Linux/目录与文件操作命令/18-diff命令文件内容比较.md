# linux系统-diff命令（文件内容比较）

<span style="color:rgb(100,180,246);font-size:11pt">最后更新：2021-07-31</span>

## 1、概述
windows系统下面有些不错的文本对比工具可以使用，例如Beyond Compare、WinMerge等都是图形界面的比较工具且使用方便。在linux环境下工作的人来说，如果每次想看两个文件的区别都要将文件下载到windows环境然后用图形工具进行比较过于麻烦。那么我们必须学会使用linux环境下的文本内容比较工具 diff。

diff以逐行的方式，比较文本文件的异同处。如果指定要比较目录，则diff会比较目录中相同文件名的文件，但不会比较其中子目录。

## 2、语法格式

```
diff [-abBcdefHilnNpPqrstTuvwy][文件1或目录1][文件2或目录2]
```

## 3、常用参数选项

```
-<行数>：指定要显示多少行的文本。此参数必须与-c或-u参数一并使用。

-a或--text：diff预设只会逐行比较文本文件。

-b或--ignore-space-change：不检查空格字符的不同。

-B或--ignore-blank-lines：不检查空白行。

-c：显示全部内文，并标出不同之处。

-C<行数>或--context<行数>：与执行"-c-<行数>"指令相同。

-H或--speed-large-files：比较大文件时，可加快速度。

-i或--ignore-case：不检查大小写的不同。

-N或--new-file：在比较目录时，若文件A仅出现在某个目录中，预设会显示：Only in目录：文件A若使用-N参数，则diff会将文件A与一个空白的文件比较。

-p：若比较的文件为C语言的程序码文件时，显示差异所在的函数名称。

-P或--unidirectional-new-file：与-N类似，但只有当第二个目录包含了一个第一个目录所没有的文件时，才会将这个文件与空白的文件做比较。

-q或--brief：仅显示有无差异，不显示详细的信息。

-r或--recursive：比较子目录中的文件。

-s或--report-identical-files：若没有发现任何差异，仍然显示信息。

-S<文件>或--starting-file<文件>：在比较目录时，从指定的文件开始比较。

-t或--expand-tabs：在输出时，将tab字符展开。

-T或--initial-tab：在每行前面加上tab字符以便对齐。

-u,-U<列数>或--unified=<列数>：以合并的方式来显示文件内容的不同。

-v或--version：显示版本信息。

-w或--ignore-all-space：忽略全部的空格字符。

-W<宽度>或--width<宽度> ：在使用-y参数时，指定栏宽。

-x<文件名或目录>或--exclude<文件名或目录>：不比较选项中所指定的文件或目录。

-X<文件>或--exclude-from<文件>：您可以将文件或目录类型存成文本文件，然后在=<文件>中指定此文本文件。

-y或--side-by-side：以并列的方式显示文件的异同之处。
```

## 4、常见用例

```
[root@ELK1 ~]# more 1.txt
1
2
22
t
t
[root@ELK1 ~]# more 2.txt
1
2
77
t
xx
```

### （1）不添加参数，比较两个文件

```
[root@ELK1 ~]# diff 1.txt 2.txt
3c3
< 22
---
> 77
6c6
< t
---
> xx
```

结果显示说明：3c3与6c6，表示两个文件第三行、第六行内容有所不同.第三行一个内容为22，另一个为77。第6行，一个内容为t,另一个内容为xx。

### （2）并排输出

-y：并列输出   -W：指定宽度（栏宽）
```
[root@ELK1 ~]# diff 1.txt 2.txt -y -W 20
1       1
2       2
22    | 77
t       t
t     | xx
y     <
```
显示结果说明：第一列为1.txt内容，第二行为2.txt内容。

“|”表示前后2个文件内容有不同；

“<”表示后面文件比前面文件少了1行内容；

“>”表示后面文件比前面文件多了1行内容。

### （3）上下文输出格式

-c：显示全部内文，并标出不同之处

```
[root@ELK1 ~]# diff 1.txt 2.txt -c
*** 1.txt       2021-07-29 15:33:49.264277748 +0800
--- 2.txt       2021-07-29 15:33:32.876360925 +0800
***************
*** 1,7 ****
  1
  2
! 22
  t
! t
! y
--- 1,6 ----
  1
  2
! 77
  t
! xx
[root@ELK1 ~]#
```
